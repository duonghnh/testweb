<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <title>Demo01: duong</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="css/app.css" rel="stylesheet" />
  <script src="scripts/jquery.js"></script>
  <script src="scripts/powerbi.min.js"></script>
</head>

<body>

  <div id="embedContainer" />

  <script>

    // data required for embedding Power BI report
    var embedReportId = "c1b73308-ecd9-46ae-9e3b-b9b5e58b1a7f";
    var embedUrl = "https://app.powerbi.com/reportEmbed";
    var accessToken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSIsImtpZCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSJ9.eyJhdWQiOiJodHRwczovL2FuYWx5c2lzLndpbmRvd3MubmV0L3Bvd2VyYmkvYXBpIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvMjQ3YTEwOTctODg5My00YzMzLThmYTctMjNmMzJhOGI3MjYyLyIsImlhdCI6MTcwMTczODU0MywibmJmIjoxNzAxNzM4NTQzLCJleHAiOjE3MDE3NDI5MzcsImFjY3QiOjAsImFjciI6IjEiLCJhaW8iOiJBVFFBeS84VkFBQUErOEEvdUFjR3BGdUxrZFlKWVNHanBYZEtPOFo4eVRCYlZZc2U0LzVVSVp3U0VwZTBQcmRXTlpwQzVxNnBuS1MvIiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6Ijg3MWMwMTBmLTVlNjEtNGZiMS04M2FjLTk4NjEwYTdlOTExMCIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiQW5hbHl0aWNzIiwiZ2l2ZW5fbmFtZSI6IlJFNDAiLCJpcGFkZHIiOiIxMTMuMTYxLjEwMC4xMjAiLCJuYW1lIjoiUkU0MCBBbmFseXRpY3MiLCJvaWQiOiIzMmJkMDY2NS0yY2E0LTQwOWQtYmY3OC1kMGJhZDM0NzNlZmQiLCJwdWlkIjoiMTAwMzIwMDFGRDMyNEExNSIsInJoIjoiMC5BWFlBbHhCNkpKT0lNMHlQcHlQektvdHlZZ2tBQUFBQUFBQUF3QUFBQUFBQUFBQ1pBQzAuIiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoiLUZZeHJFcEp6aHZJYi15bUVMUEx4Rk9KajBxUEg4Q2gtUExlbjZqSUlxcyIsInRpZCI6IjI0N2ExMDk3LTg4OTMtNGMzMy04ZmE3LTIzZjMyYThiNzI2MiIsInVuaXF1ZV9uYW1lIjoiYW5hbHl0aWNzQHJlNDAuY28ubnoiLCJ1cG4iOiJhbmFseXRpY3NAcmU0MC5jby5ueiIsInV0aSI6ImhDbVZDRUl1WmsyQnViZzhiX1FWQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjYyZTkwMzk0LTY5ZjUtNDIzNy05MTkwLTAxMjE3NzE0NWUxMCIsImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfcGwiOiJlbi1VUyJ9.dHuq-ZANbVnMEqujLzF9dAnsGr8WUUAedyOE5rb4cyVzCovECdni8IZlfMlS52gZ5XFTXt7JCQKc3CMF74nw8272gpKKMVMo_16GsAicZu9baj4KhUFOaZivmSXbNerRn-tIMYNSQxEX048G3sJS0kGJS4fed3FAZMAOeoBBmNhZwSVLFxPCMQT2AL3ZWqvhuaSCFoY8_EY_XaJCUhArkeJRhVVUPuQrQ6B1HL9haZRzUUPqKR0XfNtrRV1KGXltFAvmpAz73n3S8jVzA8RIG4fKINvQOcIGPyFrjToW_MWuSvPfEWGus9gV6yNCrXi4CJiaJzN0JbJPHV6DBroiDQ"
	var models = window['powerbi-client'].models;
    var webhookUrl = 'https://webhook.site/ca4dc469-7324-4826-9976-22e2df3e8668'

    var config = {
      type: 'report',
      id: embedReportId,
      embedUrl: embedUrl,
      accessToken: accessToken,
      tokenType: models.TokenType.Aad
    };
//     var config = {
//   type: 'report',
//   id: embedReportId,
//   embedUrl: embedUrl,
//   accessToken: accessToken,
//   tokenType: models.TokenType.Embed,
//   settings: {
//     filterPaneEnabled: false,
//     navContentPaneEnabled: false
//   },
//   permissions: models.Permissions.All,
//   viewMode: models.ViewMode.View,
//   iframe: document.getElementById('embedContainer')
// };


    // Get a reference to the embedded report HTML element
    var reportContainer = document.getElementById('embedContainer');

    // Embed the report and display it within the div container.
    var report = powerbi.embed(reportContainer, config);
    
    // Display Report object in browser console window
    console.log(report);

    // code to resize the reportContainer to the size of the hosting browser window.
    $(function () {
      var widthBuffer = 12;
      var heightBuffer = 12;
      $("#embedContainer").height($(window).height() - (heightBuffer));
      $("#embedContainer").width($(window).width() - widthBuffer);
      $(window).resize(function () {
        $("#embedContainer").height($(window).height() - (heightBuffer));
        $("#embedContainer").width($(window).width() - widthBuffer);
      });
    });
	
    var scriptTag = document.createElement('script');
    scriptTag.innerHTML = "(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PZFBZQ7M');";

     document.head.appendChild(scriptTag);
    var scriptTag2 = document.createElement('script');
    scriptTag2.innerHTML = '(<!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PZFBZQ7M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) -->);';

     document.body.appendChild(scriptTag2);
report.off("dataSelected");

// report.on will add an event listener.
report.on("dataSelected", function (event) {
    let data = event.detail;
    fetch(webhookUrl)
    console.log("Event - dataSelected:\n", data);
	dataLayer.push({
	  event: "form_submit",
	  eventModel: {
	    // ... (other properties)
	    form_submit_text: data,
	    // ... (other properties)
	  },
	  // ... (other properties)
	})
});
	  
  </script>
	    <div id="embedContainer"></div>
<br>
  <button id="saveDataBtn1">Save Data1</button>
	   <button id="saveDataBtn2">Save Data2</button>
	  <input type="text" id="dataInput" value = "test" placeholder="Enter data" />
<button type="button">Click Me!</button>
<form action="#" method="post">
    <!-- Các trường biểu mẫu khác có thể ở đây -->
   <input type="text" id="dataInput1" value = "test1" placeholder="Enter data" />
    <!-- Nút Submit -->
    <input type="submit" value="Submit">
  </form>

</body>
</html>
