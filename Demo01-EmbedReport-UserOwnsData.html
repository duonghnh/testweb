<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <title>Demo01: duong</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="css/app.css" rel="stylesheet" />
  <script src="scripts/jquery.js"></script>
  <script src="scripts/powerbi.min.js"></script>
</head>

<body>

  <div id="embedContainer" />

  <script>

    // data required for embedding Power BI report
    var embedReportId = "c1b73308-ecd9-46ae-9e3b-b9b5e58b1a7f";
    var embedUrl = "https://app.powerbi.com/reportEmbed";
    var accessToken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSIsImtpZCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSJ9.eyJhdWQiOiJodHRwczovL2FuYWx5c2lzLndpbmRvd3MubmV0L3Bvd2VyYmkvYXBpIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvMjQ3YTEwOTctODg5My00YzMzLThmYTctMjNmMzJhOGI3MjYyLyIsImlhdCI6MTcwMTcwNTEwMiwibmJmIjoxNzAxNzA1MTAyLCJleHAiOjE3MDE3MDk2NzcsImFjY3QiOjAsImFjciI6IjEiLCJhaW8iOiJBVFFBeS84VkFBQUFBUThEd01admxCeFJaNmR4ZWY5bEpsNGhuYm9RaUxLeDNWdkZLVUVodDZDMXJ3TWtQbTJIWGpyTUdWQi96VGR3IiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6Ijg3MWMwMTBmLTVlNjEtNGZiMS04M2FjLTk4NjEwYTdlOTExMCIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiQW5hbHl0aWNzIiwiZ2l2ZW5fbmFtZSI6IlJFNDAiLCJpcGFkZHIiOiIxLjUzLjUxLjkyIiwibmFtZSI6IlJFNDAgQW5hbHl0aWNzIiwib2lkIjoiMzJiZDA2NjUtMmNhNC00MDlkLWJmNzgtZDBiYWQzNDczZWZkIiwicHVpZCI6IjEwMDMyMDAxRkQzMjRBMTUiLCJyaCI6IjAuQVhZQWx4QjZKSk9JTTB5UHB5UHpLb3R5WWdrQUFBQUFBQUFBd0FBQUFBQUFBQUNaQUMwLiIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInNpZ25pbl9zdGF0ZSI6WyJrbXNpIl0sInN1YiI6Ii1GWXhyRXBKemh2SWIteW1FTFBMeEZPSmowcVBIOENoLVBMZW42aklJcXMiLCJ0aWQiOiIyNDdhMTA5Ny04ODkzLTRjMzMtOGZhNy0yM2YzMmE4YjcyNjIiLCJ1bmlxdWVfbmFtZSI6ImFuYWx5dGljc0ByZTQwLmNvLm56IiwidXBuIjoiYW5hbHl0aWNzQHJlNDAuY28ubnoiLCJ1dGkiOiIwRjhkQUdKNFNVV0Vic2N0R2pFV0FBIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLCJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX3BsIjoiZW4tVVMifQ.b1hddh_X2K5jbp29CqOznM8p3-3WmVr72hsHopVp5hH6it3erpAId3bdFiaoPhrWlvOA9KMBw31gNCi3g6_VC4SuMnsvu5EWGa5Aevq6-qxxPltwQgZyQu3qwgalnwAkOpQiyuyqQ4nrC3S8-oBe9eRwadT5Nym2Iv1CH0Skqvs1y3CEZY7dE2tGWhvv46Wt33WoXPOkPFVi0KyfpfrX7CycYemoGsulOGCYZ38wwQ2oV4nlN09BBy9XlWy3g_Tl4-YdGEeQUZyXU0cLREBEUGN-Ucls4j_qEHOBxu7ot0lfDV8u_T6jBMsis7gmnz2CuRDmRCORRjUajbpC-OAH6w"   // Get models object to access enums for embed configuration
    var models = window['powerbi-client'].models;
    var webhookUrl = 'https://webhook.site/ca4dc469-7324-4826-9976-22e2df3e8668'

    var config = {
      type: 'report',
      id: embedReportId,
      embedUrl: embedUrl,
      accessToken: accessToken,
      tokenType: models.TokenType.Aad
    };
//     var config = {
//   type: 'report',
//   id: embedReportId,
//   embedUrl: embedUrl,
//   accessToken: accessToken,
//   tokenType: models.TokenType.Embed,
//   settings: {
//     filterPaneEnabled: false,
//     navContentPaneEnabled: false
//   },
//   permissions: models.Permissions.All,
//   viewMode: models.ViewMode.View,
//   iframe: document.getElementById('embedContainer')
// };


    // Get a reference to the embedded report HTML element
    var reportContainer = document.getElementById('embedContainer');

    // Embed the report and display it within the div container.
    var report = powerbi.embed(reportContainer, config);
    
    // Display Report object in browser console window
    console.log(report);

    // code to resize the reportContainer to the size of the hosting browser window.
    $(function () {
      var widthBuffer = 12;
      var heightBuffer = 12;
      $("#embedContainer").height($(window).height() - (heightBuffer));
      $("#embedContainer").width($(window).width() - widthBuffer);
      $(window).resize(function () {
        $("#embedContainer").height($(window).height() - (heightBuffer));
        $("#embedContainer").width($(window).width() - widthBuffer);
      });
    });
	
    var scriptTag = document.createElement('script');
    scriptTag.innerHTML = "(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PZFBZQ7M');";

     document.head.appendChild(scriptTag);
    var scriptTag2 = document.createElement('script');
    scriptTag2.innerHTML = '(<!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PZFBZQ7M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) -->);';

     document.body.appendChild(scriptTag2);
report.off("dataSelected");

// report.on will add an event listener.
report.on("dataSelected", function (event) {
    let data = event.detail;
    fetch(webhookUrl)
    console.log("Event - dataSelected:\n", data);
});
  </script>
<button type="button">Click Me!</button>
</body>
</html>
